<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Token Reader</title>
</head>
<body>
    <div>Auth in process ...</div>

    <script>
        window.onload = function() {
            // First, check if there's a token in local storage
            const storedToken = localStorage.getItem('jwt_token');

            if (storedToken) {
                // Token is already in local storage, use it
                console.log("Token found in local storage: " + storedToken);
                // You can proceed with the authentication process using the stored token
            } else {
                // No token in local storage, check the URL parameters to get the token
                const urlParams = new URLSearchParams(window.location.search);
                const token = urlParams.get('jwt_token');

                if (token) {
                    // Token found in URL, store it in local storage for future use
                    localStorage.setItem('jwt_token', token);
                    console.log("Token received from URL and stored in local storage: " + token);
                    // You can proceed with the authentication process using the received token
                } else {
                    // No token found either in local storage or URL
                    console.log("No token found in local storage or URL");
                    
                    // Redirect back to the first domain to request the token
                    window.location.href = 'https://6330-197-53-134-157.ngrok-free.app/sender.html';
                }
            }
        }
    </script>
</body>
</html>